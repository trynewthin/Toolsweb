<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <!-- TOOL_META { "title": "cURL è½¬ FFmpeg", "desc": "æå– URL ä¸å…³é”®å¤´ï¼Œç”Ÿæˆå¯ç›´æ¥ä½¿ç”¨çš„ FFmpeg æŒ‡ä»¤ã€‚", "tags": ["æ•ˆç‡", "å¼€å‘"], "path": "tools/curl2ffmpeg.html" } -->
    <meta charset="UTF-8">
    <title>cURL è½¬ FFmpeg åŠ©æ‰‹</title>
    <style>
        :root { --primary: #2563eb; --bg: #f8fafc; }
        body { font-family: -apple-system, sans-serif; background: var(--bg); padding: 40px; color: #1e293b; }
        .container { max-width: 900px; margin: 0 auto; background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1); }
        h2 { margin-top: 0; color: var(--primary); border-bottom: 2px solid #e2e8f0; padding-bottom: 10px; }
        textarea { width: 100%; height: 180px; padding: 12px; border: 1px solid #cbd5e1; border-radius: 6px; font-family: 'Cascadia Code', 'Courier New', monospace; font-size: 13px; box-sizing: border-box; resize: vertical; }
        .controls { margin: 20px 0; display: flex; gap: 10px; align-items: center; flex-wrap: wrap; }
        input[type="text"] { padding: 8px; border: 1px solid #cbd5e1; border-radius: 4px; width: 200px; }
        button { padding: 10px 20px; background: var(--primary); color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; transition: opacity 0.2s; }
        button:hover { opacity: 0.9; }
        .output-area { background: #1e293b; color: #f1f5f9; padding: 20px; border-radius: 6px; position: relative; margin-top: 20px; }
        pre { white-space: pre-wrap; word-break: break-all; margin: 0; font-size: 14px; line-height: 1.5; }
        .copy-btn { position: absolute; top: 10px; right: 10px; background: #475569; font-size: 12px; padding: 5px 10px; }
        .hint { font-size: 12px; color: #64748b; margin-top: 5px; }
    </style>
</head>
<body>

<div class="container">
    <h2>ğŸš€ cURL to FFmpeg Converter</h2>
    
    <label>1. è¯·ç²˜è´´ä»æµè§ˆå™¨å¤åˆ¶çš„ cURL å‘½ä»¤ï¼š</label>
    <textarea id="curlInput" placeholder="curl 'https://...' -H 'User-Agent: ...' ..."></textarea>
    
    <div class="controls">
        <label>æœ¬åœ°ä»£ç†åœ°å€ï¼š</label>
        <input type="text" id="proxyInput" value="http://127.0.0.1:7890">
        <button onclick="convert()">ç«‹å³è½¬æ¢</button>
    </div>

    <label>2. FFmpeg è¾“å‡ºæŒ‡ä»¤ï¼š</label>
    <div class="output-area">
        <button class="copy-btn" onclick="copyResult()">å¤åˆ¶æŒ‡ä»¤</button>
        <pre id="ffmpegOutput">ç­‰å¾…è¾“å…¥...</pre>
    </div>
    <p class="hint">æç¤ºï¼šæ­¤å·¥å…·ä¼šè‡ªåŠ¨æå– URLã€Refererã€Cookie å’Œ User-Agentï¼Œå¹¶ç§»é™¤å¤šä½™çš„ Header ä»¥ä¿è¯æŒ‡ä»¤ç®€æ´ã€‚</p>
</div>

<script>
    function convert() {
        const input = document.getElementById('curlInput').value;
        const proxy = document.getElementById('proxyInput').value;
        const output = document.getElementById('ffmpegOutput');

        if (!input.trim()) {
            output.innerText = "è¯·è¾“å…¥å†…å®¹";
            return;
        }

        // æå– URL
        const urlMatch = input.match(/['"](https?:\/\/[^'"]+)['"]/);
        const url = urlMatch ? urlMatch[1] : "æœªæ‰¾åˆ°URL";

        // æå–æ ¸å¿ƒ Headers
        const getHeader = (name) => {
            const regex = new RegExp(`-H ['"]${name}:\\s*([^'"]+)['"]`, 'i');
            const match = input.match(regex);
            return match ? match[1] : null;
        };

        const ua = getHeader('User-Agent') || "Mozilla/5.0";
        const referer = getHeader('Referer');
        const cookie = getHeader('Cookie');

        // ç»„è£… FFmpeg
        let ffmpeg = `ffmpeg -user_agent "${ua}" `;
        if (referer) ffmpeg += `-headers "Referer: ${referer}" `;
        if (cookie) ffmpeg += `-headers "Cookie: ${cookie}" `;
        if (proxy) ffmpeg += `-http_proxy "${proxy}" `;
        
        // æ ¸å¿ƒä¸‹è½½é€»è¾‘
        ffmpeg += `-i "${url}" -c copy -bsf:a aac_adtstoasc "output_${Date.now()}.mp4"`;

        output.innerText = ffmpeg;
    }

    function copyResult() {
        const text = document.getElementById('ffmpegOutput').innerText;
        navigator.clipboard.writeText(text).then(() => {
            alert("å·²å¤åˆ¶åˆ°å‰ªè´´æ¿");
        });
    }
</script>

</body>
</html>
